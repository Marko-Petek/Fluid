\section{Temelji \texttt{LSFEM}}

Vse različice \texttt{FEM} vsaj okvirno temeljijo na variacijskem pristopu, kjer ne operiramo neposredno na \texttt{PDE}, ampak jih najprej pretvorimo v enakovreden variacijski problem: omislimo si \textbf{poskusno funkcijo} $\mathbf{w}(\mathbf{x})$, ki jo napnemo nad domeno $\Omega$, in izberemo funkcional $I[\mathbf{w}(\mathbf{x})]$, ki za vsako $\mathbf{w}(\mathbf{x})$ vrne neko realno število. Za uspešnost variacijskega pristopa moramo izbrati funkcional, ki vrne najmanjšo vrednost, ko je $\mathbf{w}(\mathbf{x})$ enaka rešitvi. Kadar obstaja s sistemom \texttt{PDE} povezan energijski potencial, je le-ta fizikalno najintuitivnejša izbira za konstrukcijo funkcionala. Zato ni presenetljivo, da je bila \textbf{Rayleigh-Ritzeva različica} \texttt{FEM} (\texttt{RRFEM}), ki jo na tak način dobimo, razvita prva \cite{RitzW-Variationsprobleme}. Konstrukcija funkcionala in njegova minimizacija sta tipična koraka variacijskega pristopa in nista specifična za \texttt{RRFEM}: vzamemo neko funkcijo poskusne funkcije $F\left(\mathbf{w}\right)$ in jo integriramo po domeni $\Omega$:
\vspace{-1mm}
\begin{equation}
	\hspace{17mm} \boxed{
		\vphantom{\bigg(} \ I[\mathbf{w(x)}] \, = \int_{\Omega} F\left(\mathbf{w(x)}\right) \, \ud \Omega \ } \hspace{13mm} \texttt{funkcional poskusne funkcije} \ .
	\label{eq:GeneralFunctional}
\end{equation}
Ko smo prepričani, da ima funkcional \eqref{eq:GeneralFunctional} minimum pri rešitvi $\mathbf{u}(\mathbf{x})$, sledimo znanemu Euler-Lagrange\-ve\-mu postopku. Ta nas pripelje do variacijske izjave, ki velja le, kadar je poskusna funkcija $\mathbf{w}(\mathbf{x})$ enaka rešitvi $\mathbf{u}(\mathbf{x})$. Poskusno funkcijo razvijemo okoli rešitve:
\begin{equation}
	\widetilde{\mathbf{w}}(\mathbf{x}, \varepsilon) \, = \, \mathbf{u}(\mathbf{x}) \, + \, \varepsilon \mathbf{v}(\mathbf{x}) \ ,
	\label{eq:trialFuncAroundSol}
\end{equation}
kjer je $\mathbf{v}(\mathbf{x})$ poljubna odmična funkcija, $\varepsilon$ pa realno število. Kadar gre $\varepsilon$ proti nič, gre $\widetilde{\mathbf{w}}(\mathbf{x}, \varepsilon)$ proti rešitvi problema $\mathbf{u}(\mathbf{x})$, hkrati pa vemo, da ima funkcional $I$ pri $\mathbf{u}(\mathbf{x})$ minimum. Minimum funkcionala poiščemo tako, da razvoj \eqref{eq:trialFuncAroundSol} vstavimo v funkcional \eqref{eq:GeneralFunctional} namesto $\mathbf{w}(\mathbf{x})$ in izraz odvajamo po $\varepsilon$:
\begin{equation}
	\frac{\ud I}{\ud \varepsilon} \, =
	\, \int_{\Omega} \frac{\ud}{\ud \varepsilon} F(\widetilde{\mathbf{w}}) \, \ud \Omega \, =
	\, \int_{\Omega} \frac{\ud F}{\ud \widetilde{\mathbf{w}}} \cdot \frac{\ud \widetilde{\mathbf{w}}}{\ud \varepsilon} \ \ud \Omega \, =
	\, \int_{\Omega} \frac{\ud F}{\ud \widetilde{\mathbf{w}}} \cdot \mathbf{v} \ \ud \Omega \ ,
\label{eq:funcDerivative}
\end{equation}
nato pa $\varepsilon$ v \eqref{eq:funcDerivative} pošljemo proti nič in celoten izraz enačimo z nič:
\begin{equation}
	\lim_{\varepsilon \rightarrow 0} \frac{\ud I}{\ud \varepsilon} \, = \, \lim_{\varepsilon \rightarrow 0} \int_{\Omega} \frac{\ud F(\widetilde{\mathbf{w}}(\mathbf{x}, \varepsilon))}{\ud \widetilde{\mathbf{w}}} \cdot \mathbf{v(\mathbf{x})} \ \ud \Omega \, = \, 0 \ .
\end{equation}
Limita deluje le na prvi člen v integrandu, zato se variacijska izjava glasi:
\begin{equation}
	\boxed{\, \vphantom{\bigg)^2_3}
		\int_{\Omega} \left( \lim_{\varepsilon \rightarrow 0} \frac{\ud F(\widetilde{\mathbf{w}})}{\ud \widetilde{\mathbf{w}}} \right) \cdot \mathbf{v} \ \ud \Omega \, = \, 0 \ , \quad \forall \mathbf{v(\mathbf{x})}\,
	}
	\hspace{1.3cm} \texttt{variacijska izjava} \ .
	\label{eq:variationalStatement}
\end{equation}
V jeziku funkcionalne analize, kjer na funkcije gledamo kot na vektorje, izjava pove naslednje: projekcija izraza v oklepaju na katerokoli odmično funkcijo $\mathbf{v(x)}$ mora biti enaka nič, ali krajše: izraz mora biti ortogonalen na katerokoli $\mathbf{v(x)}$.

$F\left(\mathbf{w}(\mathbf{x})\right)$ v funkcionalu poskusne funkcije je pri \texttt{RRFEM} energijski potencial, funkcional pa torej skupna potencialna energija sistema, ki jo rešitev $\mathbf{u}(\mathbf{x})$ minimizira. Zaradi tega ima \texttt{RRFEM} last\-nost najboljšega približka, diskretizacija pa vodi do simetričnega in pozitivno-definitnega sistema algebrajskih enačb, ki je zelo prikladen za reševanje s hitrimi iteracijskimi metodami. Različica metode se je izkazala v gradbenem inženirstvu, kjer je s problemom vedno povezan energijski potencial. Večina računalniških programov s tega področja zato še danes temelji na \texttt{RRFEM}.

Žal energijski potencial povezan s sistemom \texttt{PDE} ne obstaja vedno, kar je značilno za sisteme \texttt{PDE} v dinamiki tekočin. To je motiviralo razvoj Galerkinove različice \texttt{FEM} (\texttt{GFEM}), ki je zastavljena kot posplošitev \texttt{RRFEM}, vendar na precej neroden način. Ideja \texttt{GFEM} je, da lahko za vsak sistem \texttt{PDE} \eqref{eq:compactPDE} in za poljubno poskusno funkcijo $\mathbf{w(x)}$ definiramo vektor ostanka $\mathbf{R(w(x))}$. Vse člene v enačbi \eqref{eq:compactPDE} damo na eno stran in namesto $\mathbf{u(x)}$ pišemo $\mathbf{w(x)}$:
\begin{equation}
	\hspace{0mm} \boxed{\, \vphantom{\big(}
		\mathbf{R(w(x))} \, = \, \mathbsf{A}(\mathbf{x}) \cdot \mathbf{w(x)} - \mathbf{f(x)} \,
	}\hspace{20mm} \texttt{ostanek .}
	\label{eq:residual}
\end{equation}
Funkcija $\mathbf{w(x)}$, ki naredi ostanek $\mathbf{R(w(x))}$ enak nič, je rešitev problema $\mathbf{u(x)}$. Idejo za izničenje ostanka vzamemo iz variacijske izjave \eqref{eq:variationalStatement}: naj bo ostanek $\mathbf{R(w(x))}$ ortogonalen na katerokoli odmično funkcijo $\mathbf{v(x)}$:
\begin{equation}
	\int_{\Omega} \mathbf{R(w(x))} \cdot \mathbf{v(x)} \ \ud \Omega \, = \, 0 \ .
	\label{eq:GfemStatement}
\end{equation}
Pristop se imenuje \textbf{metoda uteženih ostankov} in nas za sebi-adjungirane ter pozitivno-definitne $\mathbsf{A}\mathbf{(x)}$ pripelje do istega sistema algebrajskih enačb kot \texttt{RRFEM}. Uporabimo pa ga lahko tudi za sisteme \texttt{PDE}, ki ne posedujejo teh lastnosti - takšne, ki se pojavijo v dinamiki tekočin, zato daje vtis posplošitve \texttt{RRFEM}. Akademiki so pričakovali, da bo \texttt{GFEM} v dinamiki tekočin enako uspešna, kot je bila \texttt{RRFEM} v gradbenem inženirstvu, a so se njihova pričakovanja izkazala kot preveč optimistična \cite{JiangB-LSFEM}. Težava \texttt{GFEM} izhaja iz šibkih temeljev pristopa uteženih ostankov. Načelo \eqref{eq:GfemStatement} ni nujno zvesto reševanju osnovnega problema \texttt{PDE} in v rešitvi se pogostokrat pojavijo lažne oscilacije (\emph{wiggles}). Teh se je mogoče znebiti le z močnimi izboljšavami mreže, kar očitno krni praktičnost metode. Zaradi tega obstaja cela vrsta priredb Galerkinove metode, ki skuša težavo odpraviti Zaradi tega sta metoda končnih diferenc in metoda končnih volumnov v dinamiki tekočin še vedno v modi. Večina računalniških programov za simulacije dinamike tekočin je dandanes napisana na osnovi , saj je zanjo napisane ogromno literature. To ne velja za mlajšo \texttt{LSFEM}.  To idejo uporabimo tudi pri \texttt{LSFEM}, kjer se minimizacije lotimo na legitimen način. Za $F(\mathbf{w(x)})$ vstavimo:
\begin{equation}
	F(\mathbf{w(x)}) = \mathbf{R(w(x))} \cdot \mathbf{R(w(x))} \hspace{1.3cm} \texttt{kvadrat vektorja ostanka}
\end{equation}
in minimiziramo funkcional:
\begin{equation}
	\boxed{\, I[\mathbf{w(x)}] = \int_{\Omega} \mathbf{R(w(x))} \cdot \mathbf{R(w(x))} \ \ud \Omega \,} \hspace{1.3cm} \texttt{funkcional LSFEM ,}
\end{equation}
od koder dobi metoda svoje ime.

komentirali slabosti, ki jih prinese.

Pri \texttt{LSFEM} od enačbe \eqref{eq:variationalStatement} nadaljujemo po pravilih. Imamo:
\begin{equation}
	\frac{\ud F(\widetilde{\mathbf{w}})}{\ud \widetilde{\mathbf{w}}} = 2 \mathbf{R(\widetilde{w})} \cdot \frac{\ud \mathbf{R(\widetilde{w})}}{\ud \mathbf{\widetilde{w}}} = 2 (\mathbsf{A} \cdot \mathbf{\widetilde{w}} - \mathbf{f}) \cdot \mathbsf{A}
\end{equation}
in
\begin{equation}
	\lim_{\varepsilon \rightarrow 0} \frac{\ud F(\widetilde{\mathbf{w}})}{\ud \widetilde{\mathbf{w}}} = 2 (\mathbsf{A} \cdot \mathbf{u} - \mathbf{f}) \cdot \mathbsf{A} \ .
\end{equation}
Variacijska izjava se nato glasi:
\begin{equation}
	\int_{\Omega} 2 (\mathbsf{A} \cdot \mathbf{u} - \mathbf{f}) \cdot \mathbsf{A} \cdot \mathbf{v} \ \ud \Omega = 0 \ , \quad \forall \mathbf{v(\mathbf{x})} \ . \vphantom{\Biggr{)}}
\end{equation}
Če jo rahlo preoblikujemo in zapišemo z matrikami, imamo:
\begin{equation}
	\int_{\Omega} (\mathbsf{A} \mathbf{v})^\mathsf{T} (\mathbsf{A} \mathbf{u} - \mathbf{f}) \ \ud \Omega = 0 \ , \quad \forall \mathbf{v} \ . \vphantom{\Biggr{)}}
\end{equation}

Po diskretizaciji problema \eqref{eq:GfemStatement} dobimo toliko algebrajskih enačb, kolikor vozliščnih funkcij.